<div class="container py-5">
  <div class="row">
    <div class="col-12">
      <h1 class="mb-4">Admin Settings</h1>

      <!-- Warning Alert -->
      <div class="alert alert-warning d-flex align-items-center mb-4" role="alert">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        <div>
          <strong>Warning:</strong> Changing these values is immediate and can break site
          functionality. Only update if you are certain. Never share these values with anyone.
        </div>
      </div>

      <!-- Loading State -->
      @if (loading()) {
        <div class="text-center py-5">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading settings...</span>
          </div>
          <p class="mt-3">Loading settings...</p>
        </div>
      }

      <!-- Settings List -->
      @if (!loading() && settings().length > 0) {
        <div class="card">
          <div class="card-body">
            @for (setting of settings(); track setting.key) {
              <div class="setting-item border-bottom pb-4 mb-4">
                <h5 class="mb-2">{{ setting.description }}</h5>
                <p class="text-muted small mb-3">Key: {{ setting.key }}</p>

                <form [formGroup]="getForm(setting.key)" (ngSubmit)="saveSetting(setting.key)">
                  <div class="row align-items-end">
                    <div class="col-md-8 col-lg-9">
                      <div class="mb-3 mb-md-0">
                        <label [for]="'setting-' + setting.key" class="form-label">
                          New Value
                        </label>
                        <input
                          type="password"
                          class="form-control"
                          [id]="'setting-' + setting.key"
                          formControlName="value"
                          placeholder="Enter new value (write-only)"
                          [attr.autocomplete]="'new-password'"
                        />
                        <small class="form-text text-muted">
                          This field is write-only for security. Existing values are never shown.
                        </small>
                      </div>
                    </div>
                    <div class="col-md-4 col-lg-3">
                      <button
                        type="submit"
                        class="btn btn-primary w-100"
                        [disabled]="getForm(setting.key).invalid || isSaving(setting.key)"
                      >
                        @if (isSaving(setting.key)) {
                          <span
                            class="spinner-border spinner-border-sm me-2"
                            role="status"
                            aria-hidden="true"
                          ></span>
                          Saving...
                        } @else {
                          <i class="bi bi-check-circle me-2"></i>
                          Save
                        }
                      </button>
                    </div>
                  </div>

                  <!-- Success Message -->
                  @if (getSuccessMessage(setting.key)) {
                    <div class="alert alert-success mt-3 mb-0" role="alert">
                      <i class="bi bi-check-circle-fill me-2"></i>
                      {{ getSuccessMessage(setting.key) }}
                    </div>
                  }

                  <!-- Error Message -->
                  @if (getErrorMessage(setting.key)) {
                    <div class="alert alert-danger mt-3 mb-0" role="alert">
                      <i class="bi bi-exclamation-circle-fill me-2"></i>
                      {{ getErrorMessage(setting.key) }}
                    </div>
                  }
                </form>
              </div>
            }
          </div>
        </div>
      }

      <!-- Empty State -->
      @if (!loading() && settings().length === 0) {
        <div class="alert alert-info" role="alert">
          <i class="bi bi-info-circle me-2"></i>
          No settings available. Please contact the system administrator.
        </div>
      }
    </div>
  </div>
</div>
